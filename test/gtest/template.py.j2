import torch
from torch.testing._internal.common_utils import TestCase, run_tests, run_cpp_test

TEST_BINARY = "{{ binary }}"

{% for suite in suites -%}
class Test{{ suite.name.replace("/", "_") }}(TestCase):
    cpp_name = "{{ suite.name }}"
{%- for test in suite.tests %}
    def test_{{ test.replace("/", "_") }}(self):
        run_cpp_test(TEST_BINARY, self.cpp_name, "{{ test }}")

    {% endfor %}
{% endfor -%}

if __name__ == '__main__':
    run_tests()
